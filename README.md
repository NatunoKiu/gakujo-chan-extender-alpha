# More-Better-Gakujo

学情ちゃんを使いやすくするためのブラウザ拡張機能を作りたいな～ってやつです
外部に情報を送信したりするようなことは全くないしそんなプログラムを作れるようなスキルは私にはないため安心安全です．
「More-Better」は文法的におかしい?…うるせぇ！！！気にすんな！！！！！忘れて！！！！！！！！！~~深夜テンションで命名したのでな~~

# 機能

## 2段階認証自動入力
2023/3/1に導入された手間だけはかかる認証コードによる2段階認証を自動化します．  
セットアップ方法は最後のほうに書いておきますので読んでください．  
2段階認証が2段階認証としての意味を失うためセキュリティ的には良くないですが面倒なものは面倒．初期パスワードだってちゃんと乱数パスワードなのに何故2段階認証を実装したのか．~~まさか今後の新入生の初期パスワードはp@ssw0rdになってしまうのか!?~~  

## 時間延長
残り時間が10分になると1分以内に内部で時計アイコンクリックに相当する動作を行い，残り時間を20分に戻します．  
これによりメモ帳とかワードとかでレポートを書いてから学情にコピペするという許せるっちゃ許せるけど何となくめんどくさいような気もする作業を消し去ることが出来るかもしれません．  
んでも無限に延長するとログインしっぱなしの人とか出てきて学情ちゃんが重くなりそうなんで「URLが変わった時点から大体120分」を上限としています．その後はURLが変わる操作をしない限りは延長しません．  


## レポートのソート
![レポート画面のボタン](https://github.com/koji-genba/gakujo-chan-extender/blob/Readme_images/report_firefox.png?raw=true)  
レポート提出の画面を開きますとこんな感じにボタンが追加されてます．ボタンを押すと書いてある感じにソートします．使えばわかる．  
ボタン押さなくても提出期間でソートします．  
ついでにぱっと見分かりにくいことに定評のある一時保存さんを青字で表示することにより分かりやすくします．  
### 提出期間でソート
期限内  
｜未提出  
｜一時保存  
｜提出済み  
期限切れ  
｜未提出  
｜一時保存  
｜提出済み  
の順番にソートします．  
### 開講番号でソート
そのままの意味です
### タイトルでソート
学情で表示されるタイトルでソートします．

## GPAの計算とソート
### GPA計算
いつ更新されるのかよく分からないGPAを公開済みの成績から自動で計算し表示します．
### ソート
![成績画面のボタン](https://github.com/koji-genba/gakujo-chan-extender/blob/Readme_images/score_firefox.png?raw=true)  
レポートのソートと同じ感じです．

# 環境
とりあえず最新版のFirefoxで開発しています．Chromeも動作確認を行っています．Edgeもたぶん大丈夫．

# インストール
Firefoxはこちらからどうぞ  
  
https://addons.mozilla.org/ja/firefox/addon/more-better-gakujo/  
  
ChromeとEdgeはこちらから  
  
https://chrome.google.com/webstore/detail/more-better-gakujo/gagpkjpimdfhiccjdofhpnnnecadmmod

# 使い方

## 時間延長
何もしなくても勝手に時間を延長してくれます．

## レポートソーティング
何もしなくても提出期間でソートされます．
他ソートしたいときはボタンを押して．

## GPA
### 計算
何もしなくても成績のページを開けば表のGPの行の一番上にGPAが表示されます．
### ソート
ボタンを押して．

# 2段階認証セットアップ方法
まだ学務情報システムで2段階認証をセットアップしてない場合は6から始めてください．  
既に学務情報システムで2段階認証をセットアップした人は1から始めてください．
## 1
![2FA画面1](https://github.com/koji-genba/gakujo-chan-extender/blob/Readme_images/2FA_2.png?raw=true)  
学務情報システムで2段階認証をセットアップ済みの方はリセットを行う必要があります．  
「リセット」をクリックしてリセット作業を始めます．

## 2
2,3分程度すると学籍番号のメールアドレスにsystem@mail.cc.niigata-u.ac.jpから【セキュリティキーリセット】というタイトルのメールが届いているはずです．その中のリンクをクリックします．

## 3
![2FAリセット確認画面](https://github.com/koji-genba/gakujo-chan-extender/blob/Readme_images/2FA_3.png?raw=true)  
メールのリンクをクリックすると画像のような非常に簡素でデザイン性の欠片もない画面が表示されますのでまた「リセット」をクリックします

## 4
![2FAリセット確認画面](https://github.com/koji-genba/gakujo-chan-extender/blob/Readme_images/2FA_4.png?raw=true)  
「リセット」をクリックするとしつこいぐらいに確認してくるので「OK」します．  
この時点で以前Authenicatorに登録したやつは使えなくなってるので削除して大丈夫です．(androidであれば長押し->右上ゴミ箱)  

## 5
![ログイン画面2](https://github.com/koji-genba/gakujo-chan-extender/blob/Readme_images/2FA_5.png?raw=true)  
OKするといつものログイン画面に飛ばされるのでいつも通りログインします．

## 6
![2FAセットアップ画面](https://github.com/koji-genba/gakujo-chan-extender/blob/Readme_images/2FA_7.png?raw=true)  
ログインすると2段階認証の設定画面が表示されます．1.5秒くらいで拡張機能での追加部分も表示されます．  

<span style="font-size: 200%;;">まずQRコードをGoogle Authenicatorなどの認証アプリに読み込ませてください．</span>  
そうしないとこの拡張機能がうまく動作しなかった場合に再セットアップすることになり面倒くさくなってしまいます．

次に表示されている文字列(以下面倒くさいため鍵と呼ぶ)を下部の「拡張機能2FA鍵保存フォーム」にコピペしてください．  
またこの時に，この鍵をパスワードマネージャー等の安全な場所に保存しておくことを個人的にお勧めします．  
  
<span style="font-size: 200%;;">複数のブラウザでこの拡張機能を使っている場合はすべてのブラウザに同じ鍵を入力する必要があります．</span>  
どれか一つのブラウザでこの作業を行い，その時に表示された鍵を全てのブラウザにコピペする必要があります．申し訳ありませんが同期機能を実装していないので複数PCを使うときは他PCのブラウザに対しても同じ鍵を入力する必要があります．だから鍵を保存しておく必要があったんですね．  
  
コピペしたら「save」をクリックしてください．

## 7
![ログイン画面](https://github.com/koji-genba/gakujo-chan-extender/blob/Readme_images/2FA_8.png?raw=true)  
「save」をクリックするとまたここに帰ってくるので普通にログインします．

## 8
![2FA画面](https://github.com/koji-genba/gakujo-chan-extender/blob/Readme_images/2FA_9.png?raw=true)  
2段階認証の画面になって1.5秒位すると6桁の認証コードが自動入力されます．あとは「ログイン」をクリックすればログインできるはずです．  
認証エラー等なった場合は鍵のコピペで何か間違っていないか，この作業をした後に鍵のリセットをしていないか等を確認してください．そんでもダメなときは私に連絡ください．可能な範囲で対応したりしなかったりします．

#### ※分かる人向け
この拡張機能内で生成された6桁コードはコンソールログに吐き出しています．  
鍵の設定にミスがないのに認証エラーが出ているときはコンソールログ吐き出された6桁コードと認証アプリ側の6桁コードが一致しているか確認してください．もし不一致であればissue投げといてください．
